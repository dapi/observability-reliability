# SRG-012 –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------|----------|
| **–°—Ç–∞—Ç—É—Å** | APPROVED |
| **–í–µ—Ä—Å–∏—è** | 1.0 |
| **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç** | P1 |
| **–°–ª–æ–∂–Ω–æ—Å—Ç—å** | High |
| **–¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è** | Security Engineers, SRE, DevOps, –ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä—ã |

## 1. –í–≤–µ–¥–µ–Ω–∏–µ

### 1.1 –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–î–∞–Ω–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤–∏–¥–∏–º–æ—Å—Ç—å —Å–æ–±—ã—Ç–∏–π, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é, –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—Ç—å —É–≥—Ä–æ–∑—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –Ω–æ—Ä–º–∞—Ç–∏–≤–∞–º.

### 1.2 –û–±–ª–∞—Å—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è

–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç:
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –ü–∞—Ç—Ç–µ—Ä–Ω—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å SIEM
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –∞—É–¥–∏—Ç–æ—Ä—Å–∫–∏–µ —Å–ª–µ–¥—ã
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —É–≥—Ä–æ–∑ –∏ –∞–Ω–æ–º–∞–ª–∏–π
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –Ω–æ—Ä–º–∞—Ç–∏–≤–∞–º
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –Ω–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã

### 1.3 –°–≤—è–∑–∞–Ω–Ω—ã–µ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏

- [SRG-002 Logging](SRG-002%20Logging.ru.md) - –û–±—â–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- [SRG-003 Error Tracking](SRG-003%20Error%20Tracking.ru.md) - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—à–∏–±–æ–∫
- [SRG-005 Alerting Rules](SRG-005%20Alerting%20Rules.ru.md) - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–ª–µ—Ä—Ç–∞–º–∏
- [SRO-004 Multi-Region DR](SRO-004%20Multi-Region%20DR.ru.md) - –ê–≤–∞—Ä–∏–π–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

## 2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 2.1 –£—Ä–æ–≤–Ω–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ               –¶–µ–Ω—Ç—Ä —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é (SOC)              ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ    SIEM      ‚îÇ  ‚îÇ   SOAR       ‚îÇ  ‚îÇ  Threat Intelligence ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  (Splunk,    ‚îÇ  ‚îÇ  (–ê–≤—Ç–æ–º–∞—Ç.   ‚îÇ  ‚îÇ   (–§–∏–¥—ã, IOC)        ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ   Elastic)   ‚îÇ  ‚îÇ   –æ—Ç–≤–µ—Ç)     ‚îÇ  ‚îÇ                      ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚îÇ                 ‚îÇ                     ‚îÇ
          ‚ñº                 ‚ñº                     ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    Security Data Lake                            ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ –°–æ–±—ã—Ç–∏—è      ‚îÇ  ‚îÇ  –ê—É–¥–∏—Ç       ‚îÇ  ‚îÇ  –°–µ—Ç–µ–≤—ã–µ –ø–æ—Ç–æ–∫–∏      ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ ‚îÇ  ‚îÇ  –ª–æ–≥–∏        ‚îÇ  ‚îÇ  (Flow Data)         ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚ñ≤                 ‚ñ≤                     ‚ñ≤
          ‚îÇ                 ‚îÇ                     ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    –£—Ä–æ–≤–µ–Ω—å —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö                         ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ Host-–∞–≥–µ–Ω—Ç—ã  ‚îÇ  ‚îÇ  –°–µ—Ç–µ–≤—ã–µ     ‚îÇ  ‚îÇ  –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ  ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ (Falco,      ‚îÇ  ‚îÇ  —Å–µ–Ω—Å–æ—Ä—ã     ‚îÇ  ‚îÇ  –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π          ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  OSSEC)      ‚îÇ  ‚îÇ  (Zeek,      ‚îÇ  ‚îÇ  (OWASP, WAF)        ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ              ‚îÇ  ‚îÇ   Suricata)  ‚îÇ  ‚îÇ                      ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚ñ≤                 ‚ñ≤                     ‚ñ≤
          ‚îÇ                 ‚îÇ                     ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞                               ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ Kubernetes   ‚îÇ  ‚îÇ  –û–±–ª–∞—á–Ω—ã–µ    ‚îÇ  ‚îÇ  –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è          ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ —É–∑–ª—ã         ‚îÇ  ‚îÇ  —Å–µ—Ä–≤–∏—Å—ã     ‚îÇ  ‚îÇ  –∏ —Å–µ—Ä–≤–∏—Å—ã           ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 2.2 –≠—à–µ–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∑–∞—â–∏—Ç–∞ (Defense in Depth)

| –£—Ä–æ–≤–µ–Ω—å | –§–æ–∫—É—Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ | –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã |
|---------|------------------|-------------|
| **–ü–µ—Ä–∏–º–µ—Ç—Ä** | DDoS, WAF —Å–æ–±—ã—Ç–∏—è, –ª–æ–≥–∏ —Ñ–∞–π—Ä–≤–æ–ª–∞ | Cloudflare, AWS WAF, ModSecurity |
| **–°–µ—Ç—å** | –ê–Ω–∞–ª–∏–∑ —Ç—Ä–∞—Ñ–∏–∫–∞, IDS/IPS | Zeek, Suricata, VPC Flow Logs |
| **–•–æ—Å—Ç** | –°–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã, —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å —Ñ–∞–π–ª–æ–≤ | Falco, OSSEC, Wazuh |
| **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä** | –ü–æ–≤–µ–¥–µ–Ω–∏–µ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤ | Falco, Trivy, Aqua |
| **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** | –°–æ–±—ã—Ç–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ API | Custom logging, OWASP ZAP |
| **–î–∞–Ω–Ω—ã–µ** | –ü–∞—Ç—Ç–µ—Ä–Ω—ã –¥–æ—Å—Ç—É–ø–∞, —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ | Database audit, KMS logs |

## 3. –°—Ç–∞–Ω–¥–∞—Ä—Ç—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 3.1 –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å–æ–±—ã—Ç–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

```yaml
# –¢–∞–∫—Å–æ–Ω–æ–º–∏—è —Å–æ–±—ã—Ç–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
security_events:
  authentication:  # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
    - login_success         # –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥
    - login_failure         # –ù–µ—É–¥–∞—á–Ω—ã–π –≤—Ö–æ–¥
    - logout                # –í—ã—Ö–æ–¥
    - session_timeout       # –ò—Å—Ç–µ—á–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏
    - mfa_challenge         # –ó–∞–ø—Ä–æ—Å MFA
    - mfa_success           # –£—Å–ø–µ—à–Ω—ã–π MFA
    - mfa_failure           # –ù–µ—É–¥–∞—á–Ω—ã–π MFA
    - password_change       # –°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è
    - password_reset        # –°–±—Ä–æ—Å –ø–∞—Ä–æ–ª—è

  authorization:  # –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
    - access_granted        # –î–æ—Å—Ç—É–ø –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω
    - access_denied         # –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω
    - privilege_escalation  # –ü–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π
    - role_change           # –°–º–µ–Ω–∞ —Ä–æ–ª–∏
    - permission_change     # –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π

  data_access:  # –î–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º
    - data_read             # –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
    - data_write            # –ó–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö
    - data_delete           # –£–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
    - data_export           # –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
    - bulk_operation        # –ú–∞—Å—Å–æ–≤–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è

  system:  # –°–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
    - service_start         # –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
    - service_stop          # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–∏—Å–∞
    - config_change         # –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
    - secret_access         # –î–æ—Å—Ç—É–ø –∫ —Å–µ–∫—Ä–µ—Ç–∞–º
    - certificate_operation # –û–ø–µ—Ä–∞—Ü–∏–∏ —Å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏

  network:  # –°–µ—Ç–µ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è
    - connection_established  # –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ
    - connection_blocked      # –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ
    - dns_query               # DNS-–∑–∞–ø—Ä–æ—Å
    - tls_error               # –û—à–∏–±–∫–∞ TLS

  threat:  # –£–≥—Ä–æ–∑—ã
    - malware_detected      # –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ü–û
    - intrusion_attempt     # –ü–æ–ø—ã—Ç–∫–∞ –≤—Ç–æ—Ä–∂–µ–Ω–∏—è
    - anomaly_detected      # –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –∞–Ω–æ–º–∞–ª–∏—è
    - policy_violation      # –ù–∞—Ä—É—à–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∏
```

### 3.2 –§–æ—Ä–º–∞—Ç –ª–æ–≥–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

```json
{
  "timestamp": "2024-01-15T10:30:00.123Z",
  "event_type": "authentication",
  "event_name": "login_failure",
  "severity": "warning",
  "source": {
    "service": "auth-service",
    "instance": "auth-service-7b9f5d4c8-x2k4m",
    "version": "1.2.3"
  },
  "actor": {
    "user_id": "user-123",
    "username": "john.doe@example.com",
    "session_id": "sess-abc123",
    "ip_address": "192.168.1.100",
    "user_agent": "Mozilla/5.0...",
    "geo_location": {
      "country": "US",
      "city": "New York",
      "coordinates": [40.7128, -74.0060]
    }
  },
  "target": {
    "resource_type": "user_account",
    "resource_id": "user-123",
    "action": "authenticate"
  },
  "outcome": {
    "status": "failure",
    "reason": "invalid_password",
    "attempt_count": 3
  },
  "context": {
    "request_id": "req-xyz789",
    "trace_id": "trace-abc123",
    "client_fingerprint": "fp-12345"
  },
  "risk_score": 75,
  "tags": ["brute_force_candidate", "unusual_location"]
}
```

### 3.3 –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∞—É–¥–∏—Ç–æ—Ä—Å–∫–æ–≥–æ —Å–ª–µ–¥–∞

```go
package audit

import (
    "context"
    "encoding/json"
    "time"
)

type AuditEvent struct {
    ID            string                 `json:"id"`
    Timestamp     time.Time              `json:"timestamp"`
    EventType     string                 `json:"event_type"`
    EventName     string                 `json:"event_name"`
    Severity      string                 `json:"severity"`
    Actor         Actor                  `json:"actor"`
    Target        Target                 `json:"target"`
    Outcome       Outcome                `json:"outcome"`
    Changes       []Change               `json:"changes,omitempty"`
    Context       map[string]interface{} `json:"context"`
    Metadata      map[string]interface{} `json:"metadata"`
}

type Actor struct {
    UserID      string            `json:"user_id"`
    Username    string            `json:"username"`
    Role        string            `json:"role"`
    IPAddress   string            `json:"ip_address"`
    UserAgent   string            `json:"user_agent"`
    SessionID   string            `json:"session_id"`
    ServiceName string            `json:"service_name,omitempty"`
    Attributes  map[string]string `json:"attributes,omitempty"`
}

type Target struct {
    ResourceType string `json:"resource_type"`
    ResourceID   string `json:"resource_id"`
    ResourceName string `json:"resource_name,omitempty"`
    Action       string `json:"action"`
}

type Outcome struct {
    Status     string `json:"status"` // success, failure, partial
    Reason     string `json:"reason,omitempty"`
    ErrorCode  string `json:"error_code,omitempty"`
}

type Change struct {
    Field    string      `json:"field"`
    OldValue interface{} `json:"old_value"`
    NewValue interface{} `json:"new_value"`
}

type AuditLogger interface {
    Log(ctx context.Context, event AuditEvent) error
    Query(ctx context.Context, filter AuditFilter) ([]AuditEvent, error)
}

// ImmutableAuditLogger –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∞—É–¥–∏—Ç-–ª–æ–≥–æ–≤
type ImmutableAuditLogger struct {
    writer    AuditWriter
    hasher    HashChain
    encryptor Encryptor
}

func (l *ImmutableAuditLogger) Log(ctx context.Context, event AuditEvent) error {
    // –î–æ–±–∞–≤–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é –º–µ—Ç–∫—É –∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID
    event.ID = generateUUID()
    event.Timestamp = time.Now().UTC()

    // –°–µ—Ä–∏–∞–ª–∏–∑—É–µ–º —Å–æ–±—ã—Ç–∏–µ
    data, err := json.Marshal(event)
    if err != nil {
        return err
    }

    // –î–æ–±–∞–≤–ª—è–µ–º –≤ —Ü–µ–ø–æ—á–∫—É —Ö–µ—à–µ–π –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
    hash := l.hasher.AddBlock(data)

    // –®–∏—Ñ—Ä—É–µ–º —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è
    encryptedData, err := l.encryptor.Encrypt(data)
    if err != nil {
        return err
    }

    // –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –≤ –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
    return l.writer.Write(ctx, AuditRecord{
        Data:     encryptedData,
        Hash:     hash,
        PrevHash: l.hasher.PreviousHash(),
    })
}

// HashChain –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫—É—é –ø—Ä–æ–≤–µ—Ä–∫—É —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
type HashChain struct {
    prevHash []byte
}

func (h *HashChain) AddBlock(data []byte) []byte {
    hash := sha256.Sum256(append(h.prevHash, data...))
    h.prevHash = hash[:]
    return hash[:]
}

func (h *HashChain) Verify(records []AuditRecord) bool {
    var prevHash []byte
    for _, record := range records {
        expectedHash := sha256.Sum256(append(prevHash, record.Data...))
        if !bytes.Equal(expectedHash[:], record.Hash) {
            return false
        }
        prevHash = record.Hash
    }
    return true
}
```

### 3.4 –û–±–æ–≥–∞—â–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

```python
from dataclasses import dataclass
from typing import Optional, Dict, List
import geoip2.database
import hashlib

@dataclass
class EnrichedSecurityEvent:
    original_event: Dict
    geo_data: Optional[Dict]
    threat_intel: Optional[Dict]
    user_context: Optional[Dict]
    risk_score: int
    tags: List[str]

class SecurityEventEnricher:
    def __init__(
        self,
        geoip_db_path: str,
        threat_intel_client,
        user_service_client
    ):
        self.geoip_reader = geoip2.database.Reader(geoip_db_path)
        self.threat_intel = threat_intel_client
        self.user_service = user_service_client

    async def enrich(self, event: Dict) -> EnrichedSecurityEvent:
        """–û–±–æ–≥–∞—â–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º"""

        tags = []
        risk_score = 0

        # –ì–µ–æ-–æ–±–æ–≥–∞—â–µ–Ω–∏–µ
        geo_data = None
        ip_address = event.get('actor', {}).get('ip_address')
        if ip_address:
            geo_data = self._enrich_geo(ip_address)
            if geo_data and geo_data.get('is_anonymous_proxy'):
                tags.append('anonymous_proxy')
                risk_score += 30

        # –û–±–æ–≥–∞—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏ threat intelligence
        threat_intel = await self._enrich_threat_intel(event)
        if threat_intel:
            if threat_intel.get('is_known_bad'):
                tags.append('known_threat_actor')
                risk_score += 50
            if threat_intel.get('ioc_matches'):
                tags.extend(threat_intel['ioc_matches'])
                risk_score += 40

        # –û–±–æ–≥–∞—â–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        user_context = None
        user_id = event.get('actor', {}).get('user_id')
        if user_id:
            user_context = await self._enrich_user_context(user_id, event)
            if user_context:
                if user_context.get('unusual_location'):
                    tags.append('unusual_location')
                    risk_score += 20
                if user_context.get('unusual_time'):
                    tags.append('unusual_time')
                    risk_score += 15
                if user_context.get('new_device'):
                    tags.append('new_device')
                    risk_score += 10

        # –†–∞—Å—á—ë—Ç —Ä–∏—Å–∫–∞ –ø–æ —Ç–∏–ø—É —Å–æ–±—ã—Ç–∏—è
        event_risk = self._calculate_event_risk(event)
        risk_score += event_risk

        return EnrichedSecurityEvent(
            original_event=event,
            geo_data=geo_data,
            threat_intel=threat_intel,
            user_context=user_context,
            risk_score=min(risk_score, 100),
            tags=tags
        )

    def _enrich_geo(self, ip_address: str) -> Optional[Dict]:
        """–û–±–æ–≥–∞—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏"""
        try:
            response = self.geoip_reader.city(ip_address)
            return {
                'country': response.country.iso_code,
                'city': response.city.name,
                'latitude': response.location.latitude,
                'longitude': response.location.longitude,
                'is_anonymous_proxy': response.traits.is_anonymous_proxy,
                'is_tor_exit_node': response.traits.is_tor_exit_node
            }
        except Exception:
            return None

    def _calculate_event_risk(self, event: Dict) -> int:
        """–†–∞—Å—á—ë—Ç –æ—Ü–µ–Ω–∫–∏ —Ä–∏—Å–∫–∞ –ø–æ —Ç–∏–ø—É —Å–æ–±—ã—Ç–∏—è"""
        risk_weights = {
            ('authentication', 'login_failure'): 10,
            ('authentication', 'mfa_failure'): 15,
            ('authorization', 'access_denied'): 10,
            ('authorization', 'privilege_escalation'): 40,
            ('data_access', 'bulk_operation'): 25,
            ('data_access', 'data_export'): 20,
            ('system', 'config_change'): 15,
            ('system', 'secret_access'): 20,
            ('threat', 'malware_detected'): 50,
            ('threat', 'intrusion_attempt'): 45,
        }

        event_key = (event.get('event_type'), event.get('event_name'))
        return risk_weights.get(event_key, 5)
```

## 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å SIEM

### 4.1 –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ SIEM

```yaml
# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Elastic SIEM
apiVersion: elasticsearch.k8s.elastic.co/v1
kind: Elasticsearch
metadata:
  name: security-siem
spec:
  version: 8.11.0
  nodeSets:
  - name: hot
    count: 3
    config:
      node.roles: ["master", "data_hot", "ingest"]
      xpack.security.enabled: true
      xpack.security.transport.ssl.enabled: true
    podTemplate:
      spec:
        containers:
        - name: elasticsearch
          resources:
            requests:
              memory: 8Gi
              cpu: 2
            limits:
              memory: 16Gi
              cpu: 4
    volumeClaimTemplates:
    - metadata:
        name: elasticsearch-data
      spec:
        accessModes: ["ReadWriteOnce"]
        resources:
          requests:
            storage: 500Gi
        storageClassName: fast-ssd
  - name: warm
    count: 2
    config:
      node.roles: ["data_warm"]
    volumeClaimTemplates:
    - metadata:
        name: elasticsearch-data
      spec:
        accessModes: ["ReadWriteOnce"]
        resources:
          requests:
            storage: 2Ti
        storageClassName: standard
```

### 4.2 –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–±–æ—Ä–∞ –ª–æ–≥–æ–≤

```yaml
# Filebeat –¥–ª—è —Å–±–æ—Ä–∞ –ª–æ–≥–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
apiVersion: beat.k8s.elastic.co/v1beta1
kind: Beat
metadata:
  name: security-filebeat
spec:
  type: filebeat
  version: 8.11.0
  elasticsearchRef:
    name: security-siem
  config:
    filebeat.autodiscover:
      providers:
      - type: kubernetes
        node: ${NODE_NAME}
        hints.enabled: true
        hints.default_config:
          type: container
          paths:
            - /var/log/containers/*${data.kubernetes.container.id}.log

    filebeat.inputs:
    - type: log
      enabled: true
      paths:
        - /var/log/audit/audit.log
      tags: ["linux_audit"]
      processors:
        - decode_json_fields:
            fields: ["message"]
            target: "audit"

    - type: log
      enabled: true
      paths:
        - /var/log/falco/*.log
      tags: ["falco"]
      processors:
        - decode_json_fields:
            fields: ["message"]
            target: "falco"

    processors:
    - add_kubernetes_metadata:
        host: ${NODE_NAME}
        matchers:
        - logs_path:
            logs_path: "/var/log/containers/"
    - add_cloud_metadata: ~
    - add_host_metadata: ~

    output.elasticsearch:
      hosts: ["https://security-siem-es-http:9200"]
      index: "security-logs-%{+yyyy.MM.dd}"

    setup.ilm:
      enabled: true
      rollover_alias: "security-logs"
      pattern: "{now/d}-000001"
      policy_name: "security-logs-policy"
```

### 4.3 –ü—Ä–∞–≤–∏–ª–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è

```yaml
# –ü—Ä–∞–≤–∏–ª–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è Elastic Security
# –ü—Ä–∞–≤–∏–ª–æ: –ü–æ–ø—ã—Ç–∫–∞ brute force –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
---
name: "–ü–æ–ø—ã—Ç–∫–∞ brute force –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏"
description: "–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞ —Å –æ–¥–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞"
risk_score: 73
severity: high
type: threshold
index:
  - security-logs-*
language: kuery
query: |
  event_type:authentication AND event_name:login_failure
threshold:
  field:
    - actor.ip_address
    - actor.username
  value: 5
  cardinality:
    field: actor.username
    value: 1
from: now-5m
interval: 1m
actions:
  - action_type: .slack
    params:
      message: |
        üö® –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ Brute Force –∞—Ç–∞–∫–∞
        IP –∏—Å—Ç–æ—á–Ω–∏–∫–∞: {{context.rule.threshold_field_0}}
        –¶–µ–ª–µ–≤–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: {{context.rule.threshold_field_1}}
        –ü–æ–ø—ã—Ç–æ–∫: {{state.signals_count}}
tags:
  - authentication
  - brute_force
  - attack

---
# –ü—Ä–∞–≤–∏–ª–æ: –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π
name: "–ü–æ–ø—ã—Ç–∫–∞ –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π"
description: "–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π"
risk_score: 85
severity: critical
type: eql
index:
  - security-logs-*
language: eql
query: |
  sequence by actor.user_id with maxspan=1h
    [authorization where event_name == "role_change"]
    [data_access where event_name == "bulk_operation" or event_name == "data_export"]
actions:
  - action_type: .pagerduty
    params:
      severity: critical
      summary: "–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ –ø–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π —Å –ø–æ—Å–ª–µ–¥—É—é—â–∏–º –¥–æ—Å—Ç—É–ø–æ–º –∫ –¥–∞–Ω–Ω—ã–º"

---
# –ü—Ä–∞–≤–∏–ª–æ: –ê–Ω–æ–º–∞–ª—å–Ω—ã–π –æ–±—ä—ë–º —ç–∫—Å–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö
name: "–ê–Ω–æ–º–∞–ª—å–Ω—ã–π –æ–±—ä—ë–º —ç–∫—Å–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö"
description: "–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –Ω–µ–æ–±—ã—á–Ω–æ –±–æ–ª—å—à–æ–≥–æ —ç–∫—Å–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö"
risk_score: 65
severity: medium
type: machine_learning
machine_learning_job_id: security_data_export_anomaly
anomaly_threshold: 75
```

## 5. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### 5.1 –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Falco

```yaml
# Falco DaemonSet –¥–ª—è runtime security –≤ Kubernetes
apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: falco
  namespace: security
spec:
  selector:
    matchLabels:
      app: falco
  template:
    metadata:
      labels:
        app: falco
    spec:
      serviceAccountName: falco
      hostNetwork: true
      hostPID: true
      tolerations:
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
      containers:
      - name: falco
        image: falcosecurity/falco:0.36.2
        securityContext:
          privileged: true
        args:
          - /usr/bin/falco
          - --cri=/run/containerd/containerd.sock
          - -K=/var/run/secrets/kubernetes.io/serviceaccount/token
          - -k=https://kubernetes.default
          - --k8s-node=${FALCO_K8S_NODE}
          - -pk
        env:
        - name: FALCO_K8S_NODE
          valueFrom:
            fieldRef:
              fieldPath: spec.nodeName
        volumeMounts:
        - mountPath: /run/containerd/containerd.sock
          name: containerd-socket
          readOnly: true
        - mountPath: /host/dev
          name: dev-fs
          readOnly: true
        - mountPath: /host/proc
          name: proc-fs
          readOnly: true
        - mountPath: /etc/falco
          name: falco-config
      volumes:
      - name: containerd-socket
        hostPath:
          path: /run/containerd/containerd.sock
      - name: dev-fs
        hostPath:
          path: /dev
      - name: proc-fs
        hostPath:
          path: /proc
      - name: falco-config
        configMap:
          name: falco-config
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: falco-config
  namespace: security
data:
  custom_rules.yaml: |
    # –ö–∞—Å—Ç–æ–º–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ Falco

    - rule: –î–æ—Å—Ç—É–ø –∫ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º —Ñ–∞–π–ª–∞–º
      desc: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º —Ñ–∞–π–ª–∞–º
      condition: >
        open_read and
        (fd.name startswith /etc/shadow or
         fd.name startswith /etc/passwd or
         fd.name startswith /root/.ssh/ or
         fd.name contains id_rsa or
         fd.name contains .pem) and
        not proc.name in (sshd, sudo, su, passwd)
      output: >
        –î–æ—Å—Ç—É–ø –∫ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–º—É —Ñ–∞–π–ª—É
        (user=%user.name command=%proc.cmdline file=%fd.name container=%container.id
        image=%container.image.repository k8s.pod=%k8s.pod.name k8s.ns=%k8s.ns.name)
      priority: WARNING
      tags: [filesystem, sensitive]

    - rule: Shell –∑–∞–ø—É—â–µ–Ω –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
      desc: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞ shell –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
      condition: >
        spawned_process and
        container and
        proc.name in (bash, sh, zsh, ash, dash) and
        proc.pname != entrypoint.sh and
        not container.image.repository in (
          docker.io/library/busybox,
          gcr.io/distroless/debug
        )
      output: >
        Shell –∑–∞–ø—É—â–µ–Ω –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
        (user=%user.name shell=%proc.name parent=%proc.pname
        container=%container.id image=%container.image.repository
        k8s.pod=%k8s.pod.name k8s.ns=%k8s.ns.name)
      priority: NOTICE
      tags: [container, shell]

    - rule: –ö—Ä–∏–ø—Ç–æ–º–∞–π–Ω–∏–Ω–≥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
      desc: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ –∫—Ä–∏–ø—Ç–æ–º–∞–π–Ω–∏–Ω–≥–∞
      condition: >
        spawned_process and
        (proc.name in (xmrig, minerd, minergate, stratum) or
         proc.cmdline contains "stratum+tcp" or
         proc.cmdline contains "pool.minergate")
      output: >
        –û–±–Ω–∞—Ä—É–∂–µ–Ω –∫—Ä–∏–ø—Ç–æ–º–∞–π–Ω–∏–Ω–≥
        (user=%user.name command=%proc.cmdline container=%container.id
        image=%container.image.repository)
      priority: CRITICAL
      tags: [cryptomining, malware]

    - rule: –ò—Å—Ö–æ–¥—è—â–µ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø–æ—Ä—Ç
      desc: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏—Å—Ö–æ–¥—è—â–∏—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –Ω–∞ –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–µ –ø–æ—Ä—Ç—ã
      condition: >
        outbound and
        fd.sport in (4444, 5555, 6666, 9999, 31337) and
        not container.image.repository in (security-scanner)
      output: >
        –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –∏—Å—Ö–æ–¥—è—â–µ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
        (user=%user.name command=%proc.cmdline connection=%fd.name
        container=%container.id)
      priority: WARNING
      tags: [network, suspicious]

    - rule: –î–æ—Å—Ç—É–ø –∫ Kubernetes —Å–µ–∫—Ä–µ—Ç–∞–º
      desc: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ Kubernetes —Å–µ–∫—Ä–µ—Ç–∞–º –∏–∑ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
      condition: >
        open_read and
        fd.name startswith /var/run/secrets/kubernetes.io and
        not proc.name in (kubectl, kube-proxy, kubelet)
      output: >
        –î–æ—Å—Ç—É–ø –∫ Kubernetes —Å–µ–∫—Ä–µ—Ç—É
        (user=%user.name command=%proc.cmdline file=%fd.name
        container=%container.id k8s.pod=%k8s.pod.name)
      priority: WARNING
      tags: [kubernetes, secrets]
```

### 5.2 Falco Sidekick –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –∞–ª–µ—Ä—Ç–æ–≤

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: falco-sidekick
  namespace: security
spec:
  replicas: 2
  selector:
    matchLabels:
      app: falco-sidekick
  template:
    metadata:
      labels:
        app: falco-sidekick
    spec:
      containers:
      - name: falco-sidekick
        image: falcosecurity/falcosidekick:2.28.0
        ports:
        - containerPort: 2801
        env:
        - name: SLACK_WEBHOOKURL
          valueFrom:
            secretKeyRef:
              name: falco-sidekick-secrets
              key: slack-webhook
        - name: SLACK_MINIMUMPRIORITY
          value: "warning"
        - name: ELASTICSEARCH_HOSTPORT
          value: "https://security-siem-es-http:9200"
        - name: ELASTICSEARCH_INDEX
          value: "falco"
        - name: PAGERDUTY_ROUTINGKEY
          valueFrom:
            secretKeyRef:
              name: falco-sidekick-secrets
              key: pagerduty-key
        - name: PAGERDUTY_MINIMUMPRIORITY
          value: "critical"
        - name: PROMETHEUS_ENABLED
          value: "true"
```

## 6. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ç–µ–≤–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 6.1 –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Network Policies

```go
package netmon

import (
    "context"
    "time"

    networkingv1 "k8s.io/api/networking/v1"
    metav1 "k8s.io/apimachinery/pkg/apis/meta/v1"
    "k8s.io/client-go/kubernetes"
)

type NetworkPolicyAuditor struct {
    client     kubernetes.Interface
    auditLog   AuditLogger
}

func (a *NetworkPolicyAuditor) AuditPolicies(ctx context.Context) error {
    // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ network policies
    policies, err := a.client.NetworkingV1().
        NetworkPolicies("").
        List(ctx, metav1.ListOptions{})
    if err != nil {
        return err
    }

    for _, policy := range policies.Items {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ —Å–ª–∏—à–∫–æ–º —Ä–∞–∑—Ä–µ—à–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏
        findings := a.analyzePolicyRisks(&policy)
        if len(findings) > 0 {
            a.auditLog.Log(ctx, AuditEvent{
                EventType: "network_policy_audit",
                EventName: "risky_policy_detected",
                Severity:  "warning",
                Target: Target{
                    ResourceType: "NetworkPolicy",
                    ResourceID:   string(policy.UID),
                    ResourceName: policy.Name,
                },
                Metadata: map[string]interface{}{
                    "namespace": policy.Namespace,
                    "findings":  findings,
                },
            })
        }
    }

    return nil
}

func (a *NetworkPolicyAuditor) analyzePolicyRisks(
    policy *networkingv1.NetworkPolicy,
) []string {
    var findings []string

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ allow-all ingress
    for _, ingress := range policy.Spec.Ingress {
        if len(ingress.From) == 0 {
            findings = append(findings, "allow_all_ingress")
        }
        for _, from := range ingress.From {
            if from.IPBlock != nil && from.IPBlock.CIDR == "0.0.0.0/0" {
                findings = append(findings, "allow_internet_ingress")
            }
        }
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ allow-all egress
    for _, egress := range policy.Spec.Egress {
        if len(egress.To) == 0 {
            findings = append(findings, "allow_all_egress")
        }
    }

    return findings
}

// FlowLogAnalyzer - –∞–Ω–∞–ª–∏–∑ VPC Flow Logs
type FlowLogAnalyzer struct {
    storage    FlowLogStorage
    detector   AnomalyDetector
    alerter    Alerter
}

type FlowLog struct {
    Timestamp       time.Time `json:"timestamp"`
    SourceIP        string    `json:"src_ip"`
    DestinationIP   string    `json:"dst_ip"`
    SourcePort      int       `json:"src_port"`
    DestinationPort int       `json:"dst_port"`
    Protocol        string    `json:"protocol"`
    Bytes           int64     `json:"bytes"`
    Packets         int64     `json:"packets"`
    Action          string    `json:"action"` // ACCEPT, REJECT
    Direction       string    `json:"direction"`
}

func (a *FlowLogAnalyzer) AnalyzeFlows(ctx context.Context, flows []FlowLog) error {
    // –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Ä—Ç–æ–≤
    portScanners := a.detectPortScanning(flows)
    for ip, scanDetails := range portScanners {
        a.alerter.Alert(ctx, Alert{
            Severity: "high",
            Title:    "–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤",
            Message:  fmt.Sprintf("IP %s –ø—Ä–æ—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–ª %d —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ—Ä—Ç–æ–≤", ip, scanDetails.UniquePortCount),
            Metadata: scanDetails,
        })
    }

    // –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —ç–∫—Å—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
    exfilCandidates := a.detectDataExfiltration(flows)
    for _, candidate := range exfilCandidates {
        a.alerter.Alert(ctx, Alert{
            Severity: "critical",
            Title:    "–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —ç–∫—Å—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö",
            Message:  fmt.Sprintf("–ù–µ–æ–±—ã—á–Ω—ã–π –∏—Å—Ö–æ–¥—è—â–∏–π –æ–±—ä—ë–º –¥–∞–Ω–Ω—ã—Ö: %d MB –≤ %s",
                candidate.BytesMB, candidate.DestinationIP),
            Metadata: candidate,
        })
    }

    return nil
}
```

## 7. –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —É–≥—Ä–æ–∑ –∏ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### 7.1 –ö–æ–Ω–≤–µ–π–µ—Ä –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —É–≥—Ä–æ–∑

```python
from dataclasses import dataclass
from typing import List, Dict, Optional
from enum import Enum
import asyncio

class ThreatSeverity(Enum):
    LOW = "low"
    MEDIUM = "medium"
    HIGH = "high"
    CRITICAL = "critical"

@dataclass
class DetectedThreat:
    threat_id: str
    timestamp: str
    severity: ThreatSeverity
    threat_type: str
    description: str
    indicators: List[Dict]
    affected_assets: List[str]
    evidence: List[Dict]
    recommended_actions: List[str]
    mitre_attack_techniques: List[str]

class ThreatDetectionEngine:
    def __init__(
        self,
        rule_engine,
        ml_detector,
        threat_intel_client,
        correlation_engine
    ):
        self.rule_engine = rule_engine
        self.ml_detector = ml_detector
        self.threat_intel = threat_intel_client
        self.correlation_engine = correlation_engine

    async def analyze_events(
        self,
        events: List[Dict]
    ) -> List[DetectedThreat]:
        """–ê–Ω–∞–ª–∏–∑ —Å–æ–±—ã—Ç–∏–π —á–µ—Ä–µ–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è"""

        threats = []

        # –ó–∞–ø—É—Å–∫ –º–µ—Ç–æ–¥–æ–≤ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
        results = await asyncio.gather(
            self._rule_based_detection(events),
            self._ml_based_detection(events),
            self._threat_intel_matching(events),
            self._behavioral_analysis(events)
        )

        # –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∏ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        for result_set in results:
            threats.extend(result_set)

        # –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è —É–≥—Ä–æ–∑
        correlated = await self.correlation_engine.correlate(threats)

        return correlated

    async def _rule_based_detection(
        self,
        events: List[Dict]
    ) -> List[DetectedThreat]:
        """–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª SIGMA/YARA"""

        threats = []

        for event in events:
            matches = self.rule_engine.match(event)
            for match in matches:
                threats.append(DetectedThreat(
                    threat_id=generate_threat_id(),
                    timestamp=event['timestamp'],
                    severity=ThreatSeverity(match.severity),
                    threat_type=match.threat_type,
                    description=match.description,
                    indicators=[],
                    affected_assets=[event.get('source', {}).get('service')],
                    evidence=[event],
                    recommended_actions=match.recommended_actions,
                    mitre_attack_techniques=match.mitre_techniques
                ))

        return threats

    async def _behavioral_analysis(
        self,
        events: List[Dict]
    ) -> List[DetectedThreat]:
        """–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —É–≥—Ä–æ–∑ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤"""

        threats = []

        # –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Å–æ–±—ã—Ç–∏–π –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é/—Å—É—â–Ω–æ—Å—Ç–∏
        entities = self._group_by_entity(events)

        for entity_id, entity_events in entities.items():
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∞—Ç–∞–∫
            patterns = self._detect_attack_patterns(entity_events)

            for pattern in patterns:
                threats.append(DetectedThreat(
                    threat_id=generate_threat_id(),
                    timestamp=entity_events[-1]['timestamp'],
                    severity=ThreatSeverity(pattern.severity),
                    threat_type=pattern.attack_type,
                    description=pattern.description,
                    indicators=[],
                    affected_assets=[entity_id],
                    evidence=entity_events,
                    recommended_actions=pattern.recommended_actions,
                    mitre_attack_techniques=pattern.mitre_techniques
                ))

        return threats

    def _detect_attack_patterns(
        self,
        events: List[Dict]
    ) -> List:
        """–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –∞—Ç–∞–∫"""

        patterns = []

        # –ü–∞—Ç—Ç–µ—Ä–Ω: Credential stuffing
        login_failures = [e for e in events
                        if e.get('event_name') == 'login_failure']
        if len(login_failures) > 10:
            unique_usernames = set(e.get('actor', {}).get('username')
                                  for e in login_failures)
            if len(unique_usernames) > 5:
                patterns.append(AttackPattern(
                    attack_type="credential_stuffing",
                    severity="high",
                    description="–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –Ω–µ—É–¥–∞—á–Ω—ã–µ –≤—Ö–æ–¥—ã —Å —Ä–∞–∑–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π",
                    mitre_techniques=["T1110.004"],
                    recommended_actions=[
                        "–í–∫–ª—é—á–∏—Ç—å rate limiting",
                        "–í–Ω–µ–¥—Ä–∏—Ç—å CAPTCHA",
                        "–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å IP –∏—Å—Ç–æ—á–Ω–∏–∫–∞"
                    ]
                ))

        # –ü–∞—Ç—Ç–µ—Ä–Ω: –¶–µ–ø–æ—á–∫–∞ –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π
        role_changes = [e for e in events
                       if e.get('event_name') == 'role_change']
        sensitive_access = [e for e in events
                          if e.get('event_name') in ['secret_access', 'data_export']]
        if role_changes and sensitive_access:
            patterns.append(AttackPattern(
                attack_type="privilege_escalation_chain",
                severity="critical",
                description="–°–º–µ–Ω–∞ —Ä–æ–ª–∏ —Å –ø–æ—Å–ª–µ–¥—É—é—â–∏–º –¥–æ—Å—Ç—É–ø–æ–º –∫ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º –¥–∞–Ω–Ω—ã–º",
                mitre_techniques=["T1078", "T1548"],
                recommended_actions=[
                    "–û—Ç–æ–∑–≤–∞—Ç—å –ø–æ–≤—ã—à–µ–Ω–Ω—ã–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏",
                    "–ü—Ä–æ–≤–µ—Å—Ç–∏ –∞—É–¥–∏—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ—Å—É—Ä—Å–∞–º",
                    "–°–±—Ä–æ—Å–∏—Ç—å —É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
                ]
            ))

        return patterns
```

### 7.2 –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã

```yaml
# SOAR Playbook: –†–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ Brute Force
name: brute_force_response
description: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ brute force –∞—Ç–∞–∫–∏
triggers:
  - alert_type: brute_force_authentication
    severity: [high, critical]

steps:
  - name: gather_context
    type: enrichment
    actions:
      - get_user_details:
          user_id: "{{alert.actor.user_id}}"
      - get_ip_reputation:
          ip: "{{alert.actor.ip_address}}"
      - get_recent_events:
          user_id: "{{alert.actor.user_id}}"
          timeframe: 24h

  - name: assess_risk
    type: decision
    conditions:
      - if: "{{ip_reputation.is_malicious}} == true"
        action: block_ip_immediately
      - if: "{{recent_events.failed_logins}} > 20"
        action: lock_account
      - if: "{{user_details.is_privileged}} == true"
        action: escalate_to_security
      - else:
        action: standard_response

  - name: block_ip_immediately
    type: action
    actions:
      - add_to_blocklist:
          ip: "{{alert.actor.ip_address}}"
          duration: 24h
          reason: "Brute force –∞—Ç–∞–∫–∞ - –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π IP"
      - notify:
          channel: security-alerts
          message: "–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π IP {{alert.actor.ip_address}}"

  - name: lock_account
    type: action
    actions:
      - disable_user:
          user_id: "{{alert.actor.user_id}}"
          reason: "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ - –æ–±–Ω–∞—Ä—É–∂–µ–Ω brute force"
      - notify_user:
          user_id: "{{alert.actor.user_id}}"
          template: account_locked_security
      - create_ticket:
          type: security_incident
          priority: high

  - name: escalate_to_security
    type: action
    actions:
      - page_oncall:
          team: security
          message: "–ü—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç –ø–æ–¥ brute force –∞—Ç–∞–∫–æ–π"
      - create_war_room:
          name: "Incident-{{alert.id}}"
          invite: [security, sre]

  - name: document_incident
    type: action
    run: always
    actions:
      - create_incident_report:
          alert: "{{alert}}"
          context: "{{gather_context}}"
          actions_taken: "{{steps_executed}}"
```

## 8. –ú–µ—Ç—Ä–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –¥–∞—à–±–æ—Ä–¥—ã

### 8.1 KPI –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

```yaml
# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
security_metrics:
  detection:  # –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ
    - name: mean_time_to_detect
      description: "–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è —É–≥—Ä–æ–∑—ã –¥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è"
      target: "< 5 –º–∏–Ω—É—Ç"
      calculation: "avg(detection_time - event_time)"

    - name: detection_coverage
      description: "–ü—Ä–æ—Ü–µ–Ω—Ç –∑–∞—Ö–≤–∞—á–µ–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"
      target: "> 99%"
      calculation: "captured_events / total_events * 100"

    - name: false_positive_rate
      description: "–ü—Ä–æ—Ü–µ–Ω—Ç –ª–æ–∂–Ω–æ–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –∞–ª–µ—Ä—Ç–æ–≤"
      target: "< 5%"
      calculation: "false_positive_alerts / total_alerts * 100"

  response:  # –†–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
    - name: mean_time_to_respond
      description: "–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –¥–æ –Ω–∞—á–∞–ª–∞ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è"
      target: "< 15 –º–∏–Ω—É—Ç"
      calculation: "avg(response_time - detection_time)"

    - name: mean_time_to_contain
      description: "–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –¥–æ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö —É–≥—Ä–æ–∑"
      target: "< 1 —á–∞—Å"
      calculation: "avg(containment_time - detection_time)"

    - name: mean_time_to_remediate
      description: "–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –¥–æ –ø–æ–ª–Ω–æ–≥–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞"
      target: "< 24 —á–∞—Å–∞"
      calculation: "avg(remediation_time - detection_time)"

  coverage:  # –ü–æ–∫—Ä—ã—Ç–∏–µ
    - name: asset_monitoring_coverage
      description: "–ü—Ä–æ—Ü–µ–Ω—Ç –∞–∫—Ç–∏–≤–æ–≤ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"
      target: "100%"

    - name: vulnerability_scan_coverage
      description: "–ü—Ä–æ—Ü–µ–Ω—Ç –∞–∫—Ç–∏–≤–æ–≤, –ø—Ä–æ—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–∏"
      target: "> 95%"

  compliance:  # –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –Ω–æ—Ä–º–∞—Ç–∏–≤–∞–º
    - name: policy_compliance_rate
      description: "–ü—Ä–æ—Ü–µ–Ω—Ç —Å–∏—Å—Ç–µ–º, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª–∏—Ç–∏–∫–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"
      target: "> 98%"

    - name: patch_compliance_rate
      description: "–ü—Ä–æ—Ü–µ–Ω—Ç —Å–∏—Å—Ç–µ–º —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ –ø–∞—Ç—á–∞–º–∏"
      target: "> 95%"
```

### 8.2 Grafana Dashboard

```json
{
  "dashboard": {
    "title": "–¶–µ–Ω—Ç—Ä –æ–ø–µ—Ä–∞—Ü–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (SOC)",
    "tags": ["security", "soc"],
    "panels": [
      {
        "title": "–û–±–∑–æ—Ä –∞–ª–µ—Ä—Ç–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏",
        "type": "stat",
        "gridPos": {"x": 0, "y": 0, "w": 6, "h": 4},
        "targets": [
          {
            "expr": "sum(increase(security_alerts_total[24h]))",
            "legendFormat": "–í—Å–µ–≥–æ –∞–ª–µ—Ä—Ç–æ–≤ (24—á)"
          }
        ]
      },
      {
        "title": "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã",
        "type": "stat",
        "gridPos": {"x": 6, "y": 0, "w": 6, "h": 4},
        "targets": [
          {
            "expr": "sum(increase(security_alerts_total{severity=\"critical\"}[24h]))",
            "legendFormat": "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ"
          }
        ]
      },
      {
        "title": "MTTD (–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è)",
        "type": "gauge",
        "gridPos": {"x": 12, "y": 0, "w": 6, "h": 4},
        "targets": [
          {
            "expr": "avg(security_detection_time_seconds)",
            "legendFormat": "MTTD"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "s",
            "max": 600,
            "thresholds": {
              "steps": [
                {"color": "green", "value": null},
                {"color": "yellow", "value": 180},
                {"color": "red", "value": 300}
              ]
            }
          }
        }
      },
      {
        "title": "–ê–ª–µ—Ä—Ç—ã –ø–æ —Ç–∏–ø—É",
        "type": "timeseries",
        "gridPos": {"x": 0, "y": 4, "w": 16, "h": 8},
        "targets": [
          {
            "expr": "sum by (alert_type) (rate(security_alerts_total[5m]))",
            "legendFormat": "{{alert_type}}"
          }
        ]
      },
      {
        "title": "–û—Ü–µ–Ω–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º",
        "type": "gauge",
        "gridPos": {"x": 16, "y": 4, "w": 8, "h": 8},
        "targets": [
          {
            "expr": "security_compliance_score",
            "legendFormat": "Compliance"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "percent",
            "min": 0,
            "max": 100,
            "thresholds": {
              "steps": [
                {"color": "red", "value": null},
                {"color": "yellow", "value": 80},
                {"color": "green", "value": 95}
              ]
            }
          }
        }
      }
    ]
  }
}
```

## 9. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –Ω–æ—Ä–º–∞—Ç–∏–≤–∞–º

### 9.1 –ú–∞–ø–ø–∏–Ω–≥ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è

```yaml
# –ú–∞–ø–ø–∏–Ω–≥ –∫–æ–Ω—Ç—Ä–æ–ª–µ–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è
compliance_frameworks:
  SOC2:
    security_monitoring_controls:
      CC6.1:
        description: "–õ–æ–≥–∏—á–µ—Å–∫–∏–µ –∏ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª–∏ –¥–æ—Å—Ç—É–ø–∞"
        monitoring_requirements:
          - authentication_logging
          - access_control_audit
          - session_monitoring
        evidence:
          - "–õ–æ–≥–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º, –≤—Ä–µ–º–µ–Ω–µ–º, —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º"
          - "–ê—É–¥–∏—Ç–æ—Ä—Å–∫–∏–π —Å–ª–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ—Å—Ç—É–ø–∞"
          - "–õ–æ–≥–∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å–µ—Å—Å–∏–π"

      CC6.6:
        description: "–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ–±—ã—Ç–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"
        monitoring_requirements:
          - security_event_collection
          - alert_generation
          - incident_tracking

      CC7.2:
        description: "–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã"
        monitoring_requirements:
          - performance_monitoring
          - availability_monitoring
          - anomaly_detection

  PCI_DSS:
    security_monitoring_controls:
      "10.1":
        description: "–ê—É–¥–∏—Ç–æ—Ä—Å–∫–∏–µ —Å–ª–µ–¥—ã –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤"
        monitoring_requirements:
          - user_action_logging
          - admin_action_logging
          - system_event_logging

      "10.2":
        description: "–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞—É–¥–∏—Ç–æ—Ä—Å–∫–∏–µ —Å–ª–µ–¥—ã"
        monitoring_requirements:
          - individual_user_access
          - actions_by_privileged_users
          - access_to_audit_trails
          - invalid_access_attempts

      "10.6":
        description: "–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤"
        monitoring_requirements:
          - daily_log_review_process
          - automated_log_analysis
          - exception_reporting

  GDPR:
    security_monitoring_controls:
      article_32:
        description: "–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏"
        monitoring_requirements:
          - access_logging
          - data_access_monitoring
          - breach_detection

      article_33:
        description: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–∞—Ä—É—à–µ–Ω–∏–∏"
        monitoring_requirements:
          - breach_detection_capability
          - notification_workflow
          - documentation_process
```

### 9.2 –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è

```python
from dataclasses import dataclass
from typing import List, Dict, Optional
from datetime import datetime, timedelta

@dataclass
class ComplianceCheckResult:
    control_id: str
    status: str  # compliant, non_compliant, partial, not_applicable
    evidence: List[Dict]
    findings: List[str]
    last_checked: datetime
    next_review: datetime

class ComplianceMonitor:
    def __init__(
        self,
        siem_client,
        audit_client,
        evidence_storage
    ):
        self.siem = siem_client
        self.audit = audit_client
        self.evidence = evidence_storage

    async def check_compliance(
        self,
        framework: str,
        control_ids: Optional[List[str]] = None
    ) -> List[ComplianceCheckResult]:
        """–ó–∞–ø—É—Å–∫ –ø—Ä–æ–≤–µ—Ä–æ–∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –∫–æ–Ω—Ç—Ä–æ–ª–µ–π"""

        controls = self._get_controls(framework, control_ids)
        results = []

        for control in controls:
            result = await self._check_control(control)
            results.append(result)

            # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤
            await self.evidence.store(
                control_id=control.control_id,
                check_time=datetime.utcnow(),
                result=result
            )

        return results

    async def generate_compliance_report(
        self,
        framework: str,
        period_start: datetime,
        period_end: datetime
    ) -> Dict:
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–∞ –æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ –¥–ª—è –∞—É–¥–∏—Ç–æ—Ä–æ–≤"""

        results = await self.check_compliance(framework)

        # –†–∞—Å—á—ë—Ç –æ–±—â–µ–π –æ—Ü–µ–Ω–∫–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è
        compliant_count = sum(1 for r in results if r.status == "compliant")
        total_count = len(results)
        compliance_score = (compliant_count / total_count) * 100

        return {
            "framework": framework,
            "period": {
                "start": period_start.isoformat(),
                "end": period_end.isoformat()
            },
            "overall_score": compliance_score,
            "summary": {
                "compliant": compliant_count,
                "non_compliant": sum(1 for r in results if r.status == "non_compliant"),
                "partial": sum(1 for r in results if r.status == "partial"),
                "total": total_count
            },
            "generated_at": datetime.utcnow().isoformat()
        }
```

## 10. –ß–µ–∫-–ª–∏—Å—Ç –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

### 10.1 –§–∞–∑–∞ 1: –§—É–Ω–¥–∞–º–µ–Ω—Ç (–ù–µ–¥–µ–ª–∏ 1-4)

- [ ] –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
  - [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –ª–æ–≥–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
  - [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞—É–¥–∏—Ç–æ—Ä—Å–∫–∏–π —Å–ª–µ–¥ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
  - [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É –ª–æ–≥–æ–≤ –≤ SIEM
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —É–≥—Ä–æ–∑
  - [ ] –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å Falco –¥–ª—è runtime security
  - [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
  - [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è brute force
- [ ] –°–æ–∑–¥–∞—Ç—å –¥–∞—à–±–æ—Ä–¥—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
  - [ ] –î–∞—à–±–æ—Ä–¥ –æ–±–∑–æ—Ä–∞ –∞–ª–µ—Ä—Ç–æ–≤
  - [ ] –î–∞—à–±–æ—Ä–¥ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

### 10.2 –§–∞–∑–∞ 2: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ (–ù–µ–¥–µ–ª–∏ 5-8)

- [ ] –£–ª—É—á—à–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —É–≥—Ä–æ–∑
  - [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å ML-–æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π
  - [ ] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Ñ–∏–¥—ã threat intelligence
  - [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
- [ ] –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ç–µ–≤–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
  - [ ] –ê–Ω–∞–ª–∏–∑ VPC flow logs
  - [ ] –ê—É–¥–∏—Ç network policies
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–æ–≥–∞—â–µ–Ω–∏–µ
  - [ ] GeoIP –æ–±–æ–≥–∞—â–µ–Ω–∏–µ
  - [ ] –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - [ ] –°–∫–æ—Ä–∏–Ω–≥ —Ä–∏—Å–∫–æ–≤

### 10.3 –§–∞–∑–∞ 3: –†–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (–ù–µ–¥–µ–ª–∏ 9-12)

- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ SOAR
  - [ ] –ü–ª–µ–π–±—É–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è
  - [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ç–∏–∫–µ—Ç–∏–Ω–≥–æ–º –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤
  - [ ] –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π
- [ ] –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è
  - [ ] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–∞–ø–ø–∏–Ω–≥–∞ –∫–æ–Ω—Ç—Ä–æ–ª–µ–π
  - [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è
  - [ ] –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Å–±–æ—Ä–∞ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤
- [ ] –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –æ–ø–µ—Ä–∞—Ü–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
  - [ ] Runbook-–∏ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã
  - [ ] –ü—Ä–æ—Ü–µ–¥—É—Ä—ã —ç—Å–∫–∞–ª–∞—Ü–∏–∏
  - [ ] –ü—Ä–æ—Ü–µ—Å—Å –ø–æ—Å—Ç-–∏–Ω—Ü–∏–¥–µ–Ω—Ç–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞

## 11. –°–≤—è–∑–∞–Ω–Ω—ã–µ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏

| –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è | –°–≤—è–∑—å |
|--------------|-------|
| [SRG-002 Logging](SRG-002%20Logging.ru.md) | –û—Å–Ω–æ–≤–∞ –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ |
| [SRG-003 Error Tracking](SRG-003%20Error%20Tracking.ru.md) | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –æ—à–∏–±–æ–∫ |
| [SRG-005 Alerting Rules](SRG-005%20Alerting%20Rules.ru.md) | –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∏ —ç—Å–∫–∞–ª–∞—Ü–∏—è –∞–ª–µ—Ä—Ç–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ |
| [SRO-004 Multi-Region DR](SRO-004%20Multi-Region%20DR.ru.md) | DR –¥–ª—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ |
| [SRO-002 Chaos Engineering](SRO-002%20Chaos%20Engineering.ru.md) | –•–∞–æ—Å-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ |

---

**–ò—Å—Ç–æ—Ä–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:**

| –í–µ—Ä—Å–∏—è | –î–∞—Ç–∞ | –ê–≤—Ç–æ—Ä | –ò–∑–º–µ–Ω–µ–Ω–∏—è |
|--------|------|-------|-----------|
| 1.0 | 2024-01-15 | –ö–æ–º–∞–Ω–¥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ | –ù–∞—á–∞–ª—å–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è |
